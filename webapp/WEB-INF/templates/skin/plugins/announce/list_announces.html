<div class="portlet-background append-bottom">
    <div class="portlet-background-header -lutece-border-radius-top">#i18n{announce.search_form.title}</div>
    <div class="portlet-background-content -lutece-border-radius-bottom">
        <form class="form_search" method="post" action="jsp/site/Portal.jsp">
            #i18n{announce.search_form.keyWordsLabel}
            <input type="text" size="35" value="${(filter.keywords)!}" name="keywords"/>
            <select name="category_id">
                <option value="0">#i18n{announce.search_form.defaultCategoryLabel}</option>
                <#list list_sectors as sector>
                <optgroup label="${sector.label}">
                    <#list sector.listCategories as category>
                        <#if (filter.idCategory)?? && filter.idCategory == category.id>
                            <option selected="selected" value="${category.id}">${category.label}</option>
                        <#else>
                            <option value="${category.id}">${category.label}</option>
                        </#if>
                    </#list>
                </optgroup>
                </#list>
            </select>
            <br/>
            #i18n{announce.search_form.dateMinLabel}  <input size="12" type="text" id="date_min" name="date_min" value="${filter_date_min!}"> 
            #i18n{announce.search_form.dateMaxLabel}  <input size="12" type="text" id="date_max" name="date_max" value="${filter_date_max!}">
            #i18n{announce.search_form.priceMinLabel}
            <div class="input-append">
            	<input class="input-small" size="5" type="text" id="price_min" name="price_min" value="<#if (filter.priceMin)?? && filter.priceMin &gt; 0>${filter.priceMin}</#if>">&euro;
	            <span class="add-on">&euro;</span>
            </div>
            #i18n{announce.search_form.priceMaxLabel}
            <div class="input-append">
            	<input class="input-small" size="5" type="text" id="price_max" name="price_max" value="<#if (filter.priceMax)?? && filter.priceMax &gt; 0>${filter.priceMax}</#if>">&euro;
            	<span class="add-on">&euro;</span>
            </div>
            <div class="form-actions">
	            <button class="btn btn-primary" type="submit" name="search" value="#i18n{announce.search_form.search}">
	            	<i class="icon-search icon-white">&nbsp;</i>&nbsp;#i18n{announce.search_form.search}
	            </button>
	            <a class="btn" href="jsp/site/Portal.jsp?page=announce&action=search&hasFilter=true" >
	            	<i class="icon-remove-circle">&nbsp;</i>&nbsp;#i18n{announce.search_form.reset}
	            </a> 
	            <input type="hidden" name="action" value="search" />
	            <input type="hidden" name="page" value="announce" />
	            <input type="hidden" name="hasFilter" value="true" />
	            <div class="pull-right">
	        		<#if user?? && filter?? && ( ( filter.keywords?? && filter.keywords != '' ) || filter.priceMin &gt; 0 || filter.priceMax &gt; 0 ) && filter.idFilter == 0 >
			    		<a class="btn btn-primary" href="jsp/site/Portal.jsp?page=announce-subscribe&action=doCreateSubscriptionFilter" title="#i18n{announce.labelCreateFilterSubscriptionTitle}">
			    			#i18n{announce.labelCreateFilterSubscription}
			    		</a>
			    	</#if>
		    	</div>
	   		</div>
        </form>
    </div>
</div>
<@getDatePicker idField="date_min" language=locale />
<@getDatePicker idField="date_max" language=locale />

<#if (paginator.pagesCount > 1) >
	<div class="paginator">
		Pages: <@pagination paginator=paginator />
	</div>
</#if>
<div id="content" class="portlet -lutece-border-radius">
	<#if announces_list?has_content>
		<table class="table table-striped table-condensed">
			<#list announces_list as announce>
				<tr>
					<td>
						<div class="announce-result clearfix">
							<#if announce.hasPictures>
								<#list announce.listIdImageResponse as idImageResponse>
									<#if idImageResponse_index == 0>
										<a href="jsp/site/Portal.jsp?page=announce&action=view_announce&announce_id=${announce.id}">
											<img class="thumbnail" width="80" height="80" src="image?resource_type=GENERICATTRIBUTES_RESPONSE&id=${idImageResponse}" />
										</a>
									</#if>
								</#list>
							<#else>
								<a title="${announce.title}" href="jsp/site/Portal.jsp?page=announce&action=view_announce&announce_id=${announce.id}">
									<img class="thumbnail" width="80" height="80" src="./images/local/skin/plugins/announce/no_picture.png" />
								</a>
							</#if>
							<#if announce.category.displayPrice && announce.price?has_content>
								<div class="price">
									${announce.price}
								</div>
							</#if>
							<div class="title">
								<a href="jsp/site/Portal.jsp?page=announce&action=view_announce&announce_id=${announce.id}">
									${announce.title} - <span class="category">${announce.category.label}</span>
								</a>
							</div>
							<span class="info">${announce.dateCreation}</span><br/>
							${announce.description}<br />
							<a href="jsp/site/Portal.jsp?page=announce&action=view_announces&username=${announce.userName}">
								#i18n{announce.list_announces.otherAnnounces}
							</a>
						</div>
					</td>
				</tr>
			</#list>
		</table>
	<#else>
		#i18n{announce.list_announces.noAnnounces}
	</#if>
</div>
